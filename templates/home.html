<!DOCTYPE HTML>
<html>
<head>
    <title>Flask-SocketIO Test</title>
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $(document).ready(function() {
		
		// Connect to the Socket.IO server.
		var socket = io();
		
		var username;
		
		$('#nameform').submit(function( event ) {
			var name = $('#fname').val(); //get the name the user typed in
            		socket.emit('setUsername', name}); //send a setUsername event to the server
		});
		
		//Event handler for the userJoined event.
		socket.on('userJoined', function(msg) {
			username = msg;
                	$('#start').text('You joined as ' + msg);//display the message in a paragraph
            	});
           
			
            	// Event handler for newUserEvent.
            	// Whenever the server emits a newUserEvent
            	// to the client, the data is displayed in the 
		// "New Users" section of the page.
            	socket.on('newUserEvent', function(msg) {
			if(username) //only show new users after connecting
			{
                		$('#log').append('<br>' + msg);
			}
            	});
            
        });
    </script>
</head>
<body>
    <h1>Flask-SocketIO Demo</h1>
	<form id="nameform">
  		<label for="fname">First name:</label><br>
  		<input type="text" id="fname"><br>
  		<input type="submit" value="Submit">
	</form> 
	
	<p id="start"></p>
	
    <h2>New Users:</h2>
    <div id="log"></div>
	
</body>
</html>
